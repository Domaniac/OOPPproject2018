<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
table,th,td{border:1px solid black;border-collapse: collapse;}
th,td{padding:15px;text-align: center}
#SearchForSchool{display:none;}
#SearchForTeacher{display:none;}
#SearchBySchoolName{color:blue;}
#Search_name{color:blue;}
#AdScores{display:none;}
#TerReq{display:none}
#Directory{display:none}
</style>
<script>
          var school1={name:'SClass',zone:'North',addr:'oo',PSLE:'',L1R5:16,L1R4:''};
    var school2={name:'Edog',zone:'West',addr:'o',PSLE:'',L1R5:'',L1R4:8};
    var school3={name:'woof',zone:'South',addr:'d',PSLE:'',L1R5:'',L1R4:12};
    var school4={name:'Shadow',zone:'East',addr:'s',PSLE:226,L1R5:12,L1R4:15};
    var schools=[school1,school2,school3,school4];
     //for (k in '{{ schools }}')
        //schools.push(k);
    var schoolObjects={};
    for (k in schools){
        schoolObjects[schools[k].name]=schools[k];
    }
    var teacher1={name:'John',faculty:'tech',school:'woof'};
    var teacher2={name:'woof',faculty:'sd',school:'shadow'};
    var teacher3={name:'dog',faculty:'DOg',school:'dog'};
    var teacher4={name:'pikachu',faculty:'Math',school:'doggy'};
    var teachers=[teacher1,teacher2,teacher3,teacher4];
    //for (k in '{{ teachers }}')
        //teachers.push(k);
    var teacherObjects={};
    for (k in teachers){
        teacherObjects[teachers[k].name]=teachers[k];
    }
    var For='';
    var category="none";
    var schoolSelect='SearchBySchoolName';
    var TeacherSelect='Search_name';
    var displayed={};
function selectSearch(select,activate,other){
    var clicked=document.getElementById(select);
    var on=document.getElementById(activate);
    var off=document.getElementById(other);
    on.style.display="block";
    on.disabled=false;
    if (off!=null) {
        off.style.display = "none";
        off.disabled = true;
    }
    clicked.style.color="brown";
    if (activate==="SearchForSchool") {
        category = "schools";
        Searchfor('name','SearchBySchoolName');
        displayed={};
        reset();
    }
    else{
        if(activate==="SearchForTeacher"){
            category="teachers";
            Searchfor('name','Search_name');
            displayed={};
            reset();
        }
    }
}
function Searchfor(by,click){
    For=by;
    displayed={};
    reset();
    select=document.getElementById('searchbar_input');
    select.setAttribute('onchange',"searchbar('"+by+"')");
    select.placeholder="Search by "+For+"....";
    feedback=document.getElementById(click);
    feedback.style.color="blue";
    feedback.disabled=true;
    if (by==='L1R4' || by==='L1R5' || by==='PSLE'){
        select.value=" ";
        if (by==='L1R4'){
            searchbar('L1R4');
        }
        else{
            if(by==='L1R5'){
                searchbar('L1R5')
            }
            else{
                if(by==='PSLE'){
                    searchbar('PSLE')
                }
            }
        }
    }
    if (category==="schools"){
        on=document.getElementById(schoolSelect);
        on.style.display="inline-block";
        on.disabled=false;
        on.style.color="black";
        schoolSelect=click;
    }
    else{
        on=document.getElementById(TeacherSelect);
        on.style.display="inline-block";
        on.disabled=false;
        on.style.color="black";
        TeacherSelect=click;
    }
}
function searchbar(by) {
    var table = document.getElementById("Directory");
    table.style.display = "block";
    var input = document.getElementById('searchbar_input').value;
    if (input === "") {
        displayed = {};
        reset();
        return
    }
    if (category === "teachers") {
        var list = teachers;
        if (by === 'name') {
            for (k in list) {
                var check = 1;
                if (displayed.length !== 0) {
                    for (i in displayed) {
                        if (list[k].name === i) {
                            check = 0
                        }
                    }
                }
                if (check === 1) {
                    if (list[k].name.toUpperCase().indexOf(input.toUpperCase()) !== -1) {
                        match = new RegExp(input.toUpperCase(),'g');
                        count = (list[k].name.toUpperCase().match(match) || []).length;
                        displayed[list[k].name] = count;
                    }
                }

            }
        } else {
            if (by === 'faculty') {
                for (k in list) {
                    check = 1;
                    if (displayed.length !== 0) {
                        for (i in displayed) {
                            if (list[k].name === i) {
                                check = 0
                            }
                        }
                    }
                    if (check === 1) {
                        if (list[k].faculty.toUpperCase().indexOf(input.toUpperCase()) !== -1) {
                            match = new RegExp(input.toUpperCase(),'g');
                            count = (list[k].faculty.toUpperCase().match(match) || []).length;
                            displayed[list[k].name] = count;
                        }
                    }
                }
            } else {
                if (by === 'school') {
                    for (k in list) {
                        check = 1;
                        if (displayed.length !== 0) {
                            for (i in displayed) {
                                if (list[k].name === i) {
                                    check = 0
                                }
                            }
                        }
                        if (check === 1) {
                            if (list[k].school.toUpperCase().indexOf(input.toUpperCase()) !== -1) {
                                match=new RegExp(input.toUpperCase(),'g');
                                count = (list[k].school.toUpperCase().match(match) || []).length;
                                displayed[list[k].name] = count;
                            }
                        }
                    }
                }
            }
        }
        display = Object.keys(displayed).map(function (key) {
            return [key, displayed[key]]
        });
        display = display.sort(function (a, b) {
            return b[1] - a[1]
        });
        if (!table.hasChildNodes()) {
            var header = document.createElement('CAPTION');
            var caption = document.createTextNode('Teachers');
            header.appendChild(caption);
            table.appendChild(header);
            var FirstRow = document.createElement('TR');
            var Name = document.createElement('TD');
            var NameText = document.createTextNode('Name');
            Name.appendChild(NameText);
            var Faculty = document.createElement('TD');
            var FacultyText = document.createTextNode('Faculty');
            Faculty.appendChild(FacultyText);
            var School = document.createElement('TD');
            var SchoolText = document.createTextNode('School');
            School.appendChild(SchoolText);
            FirstRow.appendChild(Name);
            FirstRow.appendChild(School);
            FirstRow.appendChild(Faculty);
            table.appendChild(FirstRow);
        }
        for (k in display){
            var row=document.createElement('TR');
            var name=document.createElement('TD');
            var nameLink=document.createElement("A");
            Link=teacherObjects[display[k][0]].name;
            nameLink.href=Link;
            var nameText=document.createTextNode(teacherObjects[display[k][0]].name);
            nameLink.appendChild(nameText);
            name.appendChild(nameLink);
            var faculty=document.createElement('TD');
            var facultyText=document.createTextNode(teacherObjects[display[k][0]].faculty);
            faculty.appendChild(facultyText);
            var school=document.createElement('TD');
            var schoolText=document.createTextNode(teacherObjects[display[k][0]].school);
            school.appendChild((schoolText));
            row.appendChild(name);
            row.appendChild(school);
            row.appendChild(faculty);
            table.appendChild(row);
        }
    } else {
        if (category === "schools") {
            list = schools;
            if (by === 'name') {
                for (k in list) {
                    check = 1;
                    if (displayed.length !== 0) {
                        for (i in displayed) {
                            if (list[k].name === i) {
                                check = 0
                            }
                        }
                    }
                    if (check === 1) {
                        if (list[k].name.toUpperCase().indexOf(input.toUpperCase()) > -1) {
                            match = new RegExp(input.toUpperCase(),'g');
                            count = (list[k].name.toUpperCase().match(match) || []).length;
                            displayed[list[k].name]=count;
                        }
                    }
                }
            } else {
                if (by === 'zone') {
                    for (k in list) {
                        check = 1;
                        if (displayed.length !== 0) {
                            for (i in displayed) {
                                if (list[k].name === i) {
                                    check = 0
                                }
                            }
                        }
                        if (check === 1) {
                            if (list[k].zone.toUpperCase().indexOf(input.toUpperCase()) > -1) {
                                match = new RegExp(input.toUpperCase(),'g');
                                count = (list[k].zone.toUpperCase().match(match) || []).length;
                                displayed[list[k].name] = count;
                            }
                        }
                    }
                } else {
                    if (by === 'address') {
                        for (k in list) {
                            check = 1;
                            if (displayed.length !== 0) {
                                for (i in displayed) {
                                    if (list[k].name === i) {
                                        check = 0
                                    }
                                }
                            }
                            if (check === 1) {
                                if (list[k].addr.toUpperCase().indexOf(input.toUpperCase()) > -1) {
                                    match = new RegExp(input.toUpperCase(),'g');
                                    count = (list[k].addr.toUpperCase().match(match) || []).length;
                                    displayed[list[k].name] = count;
                                }
                            }
                        }
                    } else {
                        if (by === 'PSLE')
                            for (k in list) {
                                check = 1;
                                if (displayed.length !== 0) {
                                    for (i in displayed) {
                                        if (list[k].name === i) {
                                            check = 0
                                        }
                                    }
                                }
                                if (check === 1) {
                                    if (list[k].PSLE !== "") {
                                        displayed[list[k].name] = list[k].PSLE
                                    }
                                }
                            }
                        else {
                            if (by === 'L1R4') {
                                for (k in list) {
                                    check = 1;
                                    if (displayed.length !== 0) {
                                        for (i in displayed) {
                                            if (list[k].name === i) {
                                                check = 0
                                            }
                                        }
                                    }
                                    if (check === 1) {
                                        if (list[k].L1R4 !== "") {
                                            displayed[list[k].name] = list[k].L1R4
                                        }
                                    }
                                }
                            } else {
                                if (by === 'L1R5') {
                                    for (k in list) {
                                        check = 1;
                                        if (displayed.length !== 0) {
                                            for (i in displayed) {
                                                if (list[k].name === i) {
                                                    check = 0
                                                }
                                            }
                                        }
                                        if (check === 1) {
                                            if (list[k].L1R5 !== "") {
                                                displayed[list[k].name] = list[k].L1R5
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            display = Object.keys(displayed).map(function (key) {
                return [key, displayed[key]]
            });
            if (by==="L1R4" || by==="L1R5"){
                display=display.sort(function(a,b){
                    return a[1]-b[1]
                })
            }
            else{
            display = display.sort(function (a, b) {
                return b[1] - a[1]
            });}
            if (!table.hasChildNodes()) {
                header = document.createElement('CAPTION');
                caption = document.createTextNode('Schools');
                header.appendChild(caption);
                table.appendChild(header);
                FirstRow = document.createElement('TR');
                Name = document.createElement('TD');
                NameText = document.createTextNode('Name');
                Name.appendChild(NameText);
                var Zone = document.createElement('TD');
                var ZoneText = document.createTextNode('Zone');
                Zone.appendChild(ZoneText);
                var Address = document.createElement('TD');
                var AddressText = document.createTextNode('Address');
                Address.appendChild(AddressText);
                if (by==='PSLE' || by==='L1R4' || by==='L1R5') {
                    var AdScore = document.createElement('TD');
                    var AdScoreText = document.createTextNode('Admission Score/' + by);
                    AdScore.appendChild(AdScoreText);
                }
                FirstRow.appendChild(Name);
                FirstRow.appendChild(Zone);
                FirstRow.appendChild(Address);
                if (by==='PSLE' || by==='L1R4' || by==='L1R5'){FirstRow.appendChild(AdScore);}
                table.appendChild(FirstRow);
            }
            for (k in display){
                row=document.createElement('TR');
                name=document.createElement('TD');
                nameText=document.createTextNode(schoolObjects[display[k][0]].name);
                name.appendChild(nameText);
                var zone=document.createElement('TD');
                var zoneText=document.createTextNode(schoolObjects[display[k][0]].zone);
                zone.appendChild(zoneText);
                var address=document.createElement('TD');
                var addressText=document.createTextNode(schoolObjects[display[k][0]].addr);
                address.appendChild(addressText);
                if (by==='L1R5'){
                    var adscore=document.createElement('TD');
                    var adscoreText=document.createTextNode(schoolObjects[display[k][0]].L1R5);
                    adscore.appendChild(adscoreText)
                }
                else{
                    if(by==='L1R4'){
                        adscore=document.createElement('TD');
                        adscoreText=document.createTextNode(schoolObjects[display[k][0]].L1R4);
                        adscore.appendChild(adscoreText);
                    }
                    else{
                        if(by==='PSLE'){
                            adscore=document.createElement('TD');
                            adscoreText=document.createTextNode(schoolObjects[display[k][0]].PSLE);
                            adscore.appendChild(adscoreText);
                        }
                    }
                }
                row.appendChild(name);
                row.appendChild(zone);
                row.appendChild(address);
                if (by==='PSLE' || by==='L1R5' || by==='L1R4'){row.appendChild(adscore)}
                table.appendChild(row);
            }
        }
    }
}
function reset(){
    document.getElementById('searchbar_input').value="";
    table=document.getElementById("Directory");
    table.style.display="none";
    while (table.firstChild) {
    table.removeChild(table.firstChild);
}
}
</script>
<body>
<div id="Search">
<div id="SearchBy">
    <button id="SearchBySchool" onclick=selectSearch("SearchBySchool","SearchForSchool","SearchForTeacher")>Search for schools</button>
    <button id="SearchByTeacher" onclick=selectSearch("SearchByTeacher","SearchForTeacher","SearchForSchool")>Search for teachers</button>
</div>
<div id="SearchForSchool" disabled>
    <button id="SearchBySchoolName" onclick=Searchfor('name','SearchBySchoolName')>Search by name</button>
    <button id="SearchBySchoolZone" onclick=Searchfor('zone','SearchBySchoolZone')>Search by zone</button>
    <button id="SearchBySchoolAddress" onclick="Searchfor('address','SearchBySchoolAddress')">Search by address</button>
    <button id="SearchBySchoolAdmission" onclick=selectSearch("SearchBySchoolAdmission","AdScores","")>search by Admission score</button>
    <div id="AdScores" disabled>
        <button id="ForSecondary" onclick="Searchfor('PSLE','ForSecondary')">PSLE</button>
        <button id="L1R5" onclick="Searchfor('L1R5','L1R5')">L1R5</button>
        <button id="L1R4" onclick="Searchfor('L1R4','L1R4')">L1R4</button>
    </div>
</div>
<div id="SearchForTeacher" disabled>
    <button id="Search_fac" onclick="Searchfor('faculty','Search_fac')">Search by faculty</button>
    <button id="Search_name" onclick="Searchfor('name','Search_name')">Search by name</button>
</div>
    <button id="reset" onclick="reset()">Reset</button>
    <br>
<input type="text" id="searchbar_input" onchange="searchbar(name)" placeholder="Search by name...">
</div>
<table id="Directory" width=100%>
</table>
</body>
</html>
